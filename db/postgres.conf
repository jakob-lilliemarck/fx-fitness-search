# PostgreSQL Configuration
# Tuned for 2GB RAM, 1vCPU dedicated database server

# Memory Settings
# shared_buffers: 25% of total RAM = 512MB (good default for dedicated DB)
shared_buffers = 512MB

# work_mem: memory per operation, total RAM / (max_connections * 2)
# = 2048MB / (20 * 2) = ~51MB per operation
work_mem = 50MB

# effective_cache_size: helps query planner; roughly 50-75% of RAM
effective_cache_size = 1GB

# maintenance_work_mem: used for VACUUM, CREATE INDEX, ALTER TABLE, etc
# Typically 10-15% of RAM
maintenance_work_mem = 256MB

# Checkpoints & WAL
# wal_buffers: write-ahead log buffer (typically 16MB is fine)
wal_buffers = 16MB

# checkpoint_completion_target: spread checkpoints over this fraction of time
# (prevents I/O spikes)
checkpoint_completion_target = 0.9

# max_wal_size: trigger checkpoint when WAL reaches this
max_wal_size = 2GB

# Connection Settings
# max_connections: adjust based on your app needs
# For a small app, 20-30 is usually enough
max_connections = 20

# Logging
# log_statement: log all queries (remove or set to 'none' in production if verbose)
log_statement = 'none'
log_duration = off
log_min_duration_statement = -1

# Performance Tuning
# random_page_cost: cost of a random disk page (1.1 for SSD, 4.0 for HDD)
# Most cloud VMs use SSD
random_page_cost = 1.1

# Parallelization (disable for small VM to reduce overhead)
max_parallel_workers = 2
max_parallel_workers_per_gather = 1

# Autovacuum (adjust based on workload)
autovacuum = on
autovacuum_naptime = 1min
autovacuum_vacuum_threshold = 50
autovacuum_analyze_threshold = 50
